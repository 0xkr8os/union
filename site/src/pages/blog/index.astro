---
import Layout from "#/layouts/Layout.astro"
import { getCollection } from "astro:content"

const isProduction = import.meta.env.PROD

let blogEntries = await getCollection("blog", ({ data }) =>
  // filter out unpublished posts in production
  isProduction ? data.hidden !== true : true
)
blogEntries = blogEntries.sort((a, b) => (a.data.date > b.data.date ? -1 : 1))
---

<Layout title='Union Blog'>
  <main
    class="flex items-center text-xl md:text-2xl mt-2 sm:mt-12 justify-center pt-6 sm:pt-0 mx-4"
  >
    <ul class="flex flex-col gap-14 flex-1 list-none p-0 max-w-2xl">
      {
        blogEntries.map(blogPostEntry => (
          <li>
            <a class="pointer-cursor" href={`/blog/${blogPostEntry.slug}`}>
              <time class="text-lg text-gray-300" datetime={blogPostEntry.data.date.toISOString()}>
                {blogPostEntry.data.date.toLocaleDateString('fr-CA', {
                  year: 'numeric',
                  month: 'numeric',
                  day: 'numeric',
                })}
              </time>
              <h2 class="text-3xl sm:text-4xl font-extrabold mb-0">{blogPostEntry.data.title}</h2>
              <p class="sm:text-xl text-gray-200">{blogPostEntry.data.description}</p>

              <div class="underline text-lg text-accent font-semibold">
                Read Post -&gt;
              </div>
            </a>
          </li>
        ))
      }
    </ul>
  </main>
</Layout>

<style is:inline>
  *::selection {
    background-color: #a0ecfd;
    color: #000;
  }
</style>
