---
import Layout from '#/layouts/Layout.astro'
import { getCollection } from 'astro:content'
import Socials from '#/components/Socials.astro'

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog')
  return blogEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }))
}

const { entry } = Astro.props
const { Content } = await entry.render()
---

<Layout
  url={Astro.url.href}
  title={entry.data.title}
  image={entry.data.backgroundImage}
  description={entry.data.description}
>
  <main
    class="sm:text-xl flex-grow mt-2 sm:mt-12 pb-16 max-w-2xl self-center flex flex-col pt-6 sm:pt-0 mx-4"
  >
    <h1 class="text-3xl sm:text-5xl font-extrabold max-w-xl">
      {entry.data.title}
    </h1>

    <div class="font-mono text-lg uppercase tracking-widest mt-1 mb-6">
      <time datetime={entry.data.date.toISOString()}>
        {
          entry.data.date.toLocaleDateString('fr-CA', {
            year: 'numeric',
            month: 'numeric',
            day: 'numeric',
          })
        }
      </time>-
      <a href="https://x.com/union_build" class="hover:underline text-accent-400">@union_build</a>
    </div>
    <Content />
  </main>
  <Socials />
</Layout>

<script type="module" src="/anchor-targets.js"></script>

<style is:inline lang="postcss">
  p > a {
    text-decoration: underline;
    text-decoration-color: #A0ECFD !important;
    transition: border-bottom-color 0.2s ease-in-out;
  }

  p {
    margin-bottom: 1rem;
  }

  p > a:hover {
    color: #A0ECFD;
  }

  ol {
    li {
      padding-top: 1rem;
    }
  }
  @media (max-width: 640px) {
    p > a:hover {
      color: #A0ECFD;
      text-decoration-color: #fff !important;
    }
    h2 {
      font-size: 1.5rem !important;
    }
  }

  h2,h3,h4,h5 {
    line-height: 3rem;
    margin-top: 1rem;
    margin-bottom: 0.25rem;
    font-size: 1.87rem;
    color: #A0ECFD;
  }

  h2::after, h3::after, h4::after, h5::after {
    content: '#';
    color: #ffffff;
    margin-left: 0.5rem;
    font-size: 1.5rem;
    position: relative;
    visibility: hidden;
  }

  h2:hover::after, h3:hover::after, h4:hover::after, h5:hover::after {
    visibility: visible;
  }

  *::selection {
    background-color: #A0ECFD;
    color: #000;
  }
</style>
