---
import { fade } from 'astro:transitions'
import xIcon from '#/assets/images/x.svg'
import Layout from '#/layouts/Layout.svelte'
import { getCollection } from 'astro:content'
import { ViewTransitions } from 'astro:transitions'
import discordIcon from '#/assets/images/discord.svg'
import calendarIcon from '#/assets/images/calendar.svg'
import CodeSnippet from '#/components/CodeSnippet.svelte'
import ConnectedVisual from '#/components/ConnectedVisual.svelte'
import PerformanceGraph from '#/components/graphs/ValidatorPerformance.svelte'
import Chart from '#/components/Chart.svelte'
import AppleGraphContainer from '#/components/graphs/AppleGraphContainer.svelte'
import { Tabs, TabItem } from '@astrojs/starlight/components'
import { Code } from 'astro:components'

let socialLinks = [
  {
    href: 'https://x.com/union_build',
    iconSrc: xIcon.src,
    cta: 'Join us on X'
  },
  {
    href: 'https://discord.union.build',
    iconSrc: discordIcon.src,
    cta: 'Join our Discord'
  },
  {
    href: 'https://x.com/union_build',
    iconSrc: calendarIcon.src,
    cta: 'Join our Events'
  }
]

const codeSnippets = [
  {
    lang: 'solidity',
    title: 'swap.sol',
    code: `
\`\`\`solidity /IBCAppBase/#accent /ibcHandler/#accent
contract DexPortal is IBCAppBase {
  function swap(
    address base,
    uint256 amount,
    uint256 minReturn,
    uint64 timeout
  ) public {
    Proxy quote = swapProxies[base];
    IERC20(base).transferFrom(
      _msgSender(),
      address(this),
      amount
    );
    ibcHandler.send(
      quote.port,
      quote.channel,
      timeout,
      abi.encode(
        Swap({
          origin: _msgSender(),
          amount: amount,
          minReturn: minReturn
        })
      )
    );
  }
}
\`\`\`
`
  },
  {
    lang: 'rust',
    title: 'swap.rs',
    code: `
\`\`\`rust /IbcMsg/#accent
fn swap(
    deps: Deps,
    env: Env,
    info: MessageInfo,
    base: String,
    amount: Uint256,
    min_return: Uint256,
    timeout: u64,
) -> Result<Response, Error> {
    let proxy = SWAP_PROXIES.load(&deps.storage, base)?;

    Ok(Response::add_message(wasm_execute(
        base,
        &cw20::msg::TransferFrom {
            owner: info.sender,
            recipient: env.contract.address,
            amount,
        },
        vec![],
    ))
    .add_message(IbcMsg::SendPacket {
        channel_id: proxy.channel,
        data: Swap {
            origin: info.sender,
            amount,
            min_return,
        },
        timeout: IbcTimeout::with_block(timeout),
    }))
}
`
  }
] satisfies Array<{ lang: string; code: string; title: string }>

let publishedBlogPosts = await getCollection('blog', ({ slug, data }) => {
  if (data.hidden) return false
  return { slug, data }
})
publishedBlogPosts.reverse()
---

<Layout>
  <main
    class='flex flex-col flex-1 items-center px-4'
    transition:animate={fade({ duration: '0.4s' })}
  >
    <div class='w-full flex flex-col max-w-5xl p-px bg-[#1f1f1f]'>
      <section
        class='flex flex-col items-center sm:py-32 py-10 gap-6 grid-effect-bg antialiased bg-black mb-px'
      >
        <div class='sm:text-7xl text-4xl text-white text-center font-semibold px-4'>
          The Sovereign<br />Interoperability Layer
        </div>
        <div class='sm:text-xl text-md max-w-lg font-normal text-center antialiased'>
          By using consensus verification, Union builds unstoppable and decentralized connections to
          enable anyone to transfer assets and data.
        </div>
        <div>
          <a
            class='mt-16 border-b-2 uppercase'
            href='/docs'
          >
            Join the community -&gt;
          </a>
        </div>
      </section>

      <section class='bg-black text-white flex flex-col items-center sm:py-16 py-2 px-4 mb-px'>
        <div class='flex md:flex-row flex-col gap-16 max-w-4xl text-balance'>
          <div class='flex-1 p-4'>
            <p class='text-3xl text-gray-500 font-normal mb-0 text-center'>
              <span class='text-white'>
                Trustless, decentralized, and permissionless interoperability is now possible.
              </span>
              Union is the only protocol that provides all three, using state-of-the art Zero-Knowledge
              cryptography.
            </p>
          </div>
        </div>
      </section>

      <section class='bg-black mb-px relative items-center justify-center'>
        <div class='absolute flex flex-col items-center w-full'>
          <h2 class='text-4xl px-6 pt-12 font-normal sm:text-3xl xs:text-xl'>
            Interoperability for the Modular Stack
          </h2>
        </div>
        <div class="w-full min-w-full h-full min-h-full">
          <ConnectedVisual />
        </div>
      </section>

      <section
        class:list={[
          'grid sm:grid-cols-2 grid-cols-1 sm:grid-rows-1 grid-rows-2 divide-x divide-solid divide-[#1f1f1f]',
          'md:flex-row max-w-4x items-center mb-px bg-black'
        ]}
      >
        <div class='p-4 sm:p-8 text-2xl font-normal text-gray-400'>
          Galois is the first interoperability proving layer that is so efficient that it allows
          anyone to <span class='text-white'>generate proofs on your phone.</span> Gone is the era of
          needing expensive cloud-clusters for ZK. Now we liberate ZK to be available to anyone.
        </div>
        <div class="w-full min-w-full h-full min-h-full">
          <PerformanceGraph client:load/>
        </div>
      </section>

      <section class='flex flex-col items-center bg-black mb-px'>
        <div
          class='grid grid-cols-1 grid-rows-2 sm:grid-cols-2 sm:grid-rows-1 divide-y sm:divide-x sm:divide-y-0 divide-solid divide-[#1f1f1f]'
        >
          <div class='w-full antialiased bg-[#050505] py-2 text-left font-monospace text-[15px]'>
            <Tabs>
              {
                codeSnippets.map(snippet => (
                  <TabItem label={snippet.title}>
                    <div class='px-3'>
                      <CodeSnippet
                        code={snippet.code}
                        client:load
                      />
                    </div>
                  </TabItem>
                ))
              }
            </Tabs>
          </div>
          <div class='p-8 text-2xl font-normal text-gray-400 '>
            <h2 class='text-4xl font-normal text-white'>Build for any stack.</h2>
            Galois is the first interoperability proving layer that is so efficient that it allows anyone
            to <span class='text-white'>generate proofs on your phone.</span> Gone is the era of needing
            expensive cloud-clusters for ZK. Now we liberate ZK to be available to anyone.
          </div>
        </div>
      </section>
      <section class='bg-black mb-px flex flex-col items-center justif-center p-12 sm:p-20 lg:p-32'>
        <h2 class='text-3xl sm:text-4xl mb-8 font-normal'>The leading interoperability layer.</h2>
        <div class='w-full'>
          <AppleGraphContainer
            bars={[
              { width: 100, label: 'CometBLS V3', primary: true },
              { width: 9.1, label: 'ZkMint*' },
              { width: 1.45, label: 'TendermintX' },
              { width: 0.77, label: 'Fraud-proof bridges' },
            ]}
            client:load
          />
        </div>
      </section>

      <section class='bg-black mb-px'>
        <div
          class='grid grid-rows-3 grid-cols-1 sm:grid-cols-3 sm:grid-rows-1 divide-y sm:divide-x sm:divide-y-0 divide-solid divide-[#1f1f1f]'
        >
          <div class='p-8'>
            <h3 class='mb-1'>Galois</h3>
            <p>
              Decentralized Proving, for everyone. Lorem ipsum dolor sit amet, consectetur
              adipiscing elit. Phasellus a enim a nisi aliquet fermentum ac eget tellus.
            </p>
          </div>
          <div class='p-8'>
            <h3 class='mb-1'>CometBLS</h3>
            <p>
              ZK-aligned Consensus engine. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
              Phasellus a enim a nisi aliquet fermentum ac eget tellus.
            </p>
          </div>
          <div class='p-8'>
            <h3 class='mb-1'>Voyager</h3>
            <p>
              Stateless relaying for a cross-chain future. Lorem ipsum dolor sit amet, consectetur
              adipiscing elit. Phasellus a enim a nisi aliquet fermentum ac eget tellus.
            </p>
          </div>
        </div>
      </section>

      <section
        class='bg-black mb-px grid grid-rows-2 grid-cols-1 sm:grid-cols-2 sm:grid-rows-1 divide-y sm:divide-x sm:divide-y-0 divide-solid divide-[#1f1f1f]'
      >
        <div class='w-full p-8 mr-px'>
          <a
            class='text-left space-y-2'
            href={`/blog/${publishedBlogPosts[0].slug}`}
          >
            <div>
              <p class='text-3xl font-bold'>
                {publishedBlogPosts[0].data.title}
              </p>
            </div>
            <p class='text-pretty text-lg text-left'>
              {publishedBlogPosts[0].data.description}
            </p>
            <a class='underline uppercase text-md font-normal'>Read more {'->'}</a>
          </a>
        </div>
        <div
          class='p-0 list-none mx-auto w-full grid grid-rows-3 divide divide-y divide-solid divide-[#1f1f1f]'
        >
          {
            publishedBlogPosts.slice(1).map(post => (
              <a
                href={`/blog/${post.slug}`}
                class='justify-center w-full h-full flex flex-col text-left flex-start px-8 py-4 my-auto'
              >
                <p class='text-xl font-bold'>{post.data.title}</p>
                <p class='underline uppercase'>Read more {'->'}</p>
              </a>
            ))
          }
        </div>
      </section>

      <section class='bg-black mb-px flex flex-col items-center justif-center py-32'>
        <div class='flex-1 max-w-4xl'>
          <h2 class='text-4xl mb-4 font-normal text-center'>Join the Union</h2>
          <div class='grid grid-cols-1 md:grid-cols-3'>
            {
              socialLinks.map(socialLink => (
                <a
                  href={socialLink.href}
                  class='flex flex-col flex-1 p-8 text-center'
                >
                  <img
                    src={socialLink.iconSrc}
                    class='h-10'
                  />
                  <div class='mt-4'>
                    <span class='mt-16 border-b-[1px] uppercase border-white text-semibold undelrine'>
                      {socialLink.cta} -&gt;
                    </span>
                  </div>
                </a>
              ))
            }
          </div>
        </div>
      </section>

      <!--
      <section>
        <img
          class='w-[300px] md:w-[500px] absolute left-[50%] -ml-[150px] md:-ml-[250px] z-10 -mt-[50px] md:-mt-[100px] eth-logo'
          src='../../../../assets/images/ethereum.svg'
          alt='Ethereum'
        />
        <div class='flex flex-col items-center z-20 relative'>
          <h2 class='text-4xl md:text-6xl font-bold text-center -mb-6'>ETH &lt;-&gt; IBC</h2>
          <h3 class='text-[16px] md:text-[27px] font-bold text-center text-gray-200'>
            Union's flagship product
          </h3>
          <p class='md:text-2xl text-center -mt-4'>
            Built using Zero-Knowledge Cryptography and BLS Signatures, a
          </p>
          <div
            class='text-center trustless-connection text-2xl md:text-5xl text-accent font-black italic animate-character animate-character-delay'
          >
            Trustless Ethereum IBC Connection
          </div>
          <p class='text-center md:text-2xl'>Live between Union's Testnet and Ethereum's Testnet.</p>
        </div>
      </section>
   -->
      <!-- <section class='flex flex-col items-center pb-56'>
        <h2 class='text-xl md:text-3xl font-bold'>Backed by industry experts</h2>

        <div class='flex flex-col md:flex-row gap-[24px] mt-[24px] items-center'>
          <img
            class='block w-[200px]'
            src='../../../../assets/images/investors/galileo.svg'
            alt='Galileo'
          />
          <img
            class='block w-[60px] mx-8'
            src='../../../../assets/images/investors/nascent.svg'
            alt='Nascent'
          />
          <img
            class='block w-[200px]'
            src='../../../../assets/images/investors/tioga.png'
            alt='Tioga'
          />
        </div>

        <div class='flex flex-col md:flex-row gap-[24px] mt-[24px] items-center'>
          <img
            class='block w-[220px]'
            src='../../../../assets/images/investors/semantic.png'
            alt='Semantic'
          />
          <img
            class='block w-[220px]'
            src='../../../../assets/images/investors/lightshift.png'
            alt='Lightshift'
          />
        </div>
  	  <div class="mt-8">
          <a
            class='mt-16 uppercase'
            href='/blog/seed-raise'
          >
            Read the announcement -&gt;
          </a>
        </div>
      </section> -->
    </div>
  </main>
</Layout>

<ViewTransitions transition:name='landing-transition' />

<style lang="postcss">

	.main-text {
		max-width: 72rem;
		font-size: 26px;
		font-weight: 900;
		text-align: center;

		@media (min-width: 340px) {
			font-size: 29px;
		}

		@media (min-width: 380px) {
			font-size: 34px;
		}

		@media (min-width: 600px) { 
			font-size: 52px;
		}

		@media (min-width: 768px) {
			font-size: 65px;
		}

		@media (min-width: 1024px) { 
			font-size: 90px;
		 }
	}

	.next-century-text {
		padding: 2px 8px;
		font-style: italic; 
		font-size: 40px;
		font-weight: 900; 
		text-align: center; 
		color: theme(colors.accent.400);
		margin: -24px -8px;
		@media (min-width: 340px) {
			font-size: 42px;
		}

		@media (min-width: 380px) {
			font-size: 44px;
		}

		@media (min-width: 600px) { 
		  font-size: 60px;
		}

		@media (min-width: 768px) {
			font-size: 70px;
		}

		@media (min-width: 1024px) { 
		  font-size: 110px;
		  line-height: 1; 
			padding: 8px 16px;
			margin: -8px 0;
		}
	}

	.tagline {
		text-align: center;
		font-size: 10px;
		margin-top: 8px;

		@media (min-width: 360px) {
			font-size: 12px;
		}
		@media (min-width: 425px) {
			font-size: 14px;
		}

		@media (min-width: 600px) { 
			font-size: 16px;
		}

		@media (min-width: 768px) {
			font-size: 24px;
		}
	}

	@keyframes textclip {
	  to {
	    background-position: 200% center;
	  }
	}

	.skew-button {
	  font-size: 12px;
	  margin-top: 16px;
	  @media(min-width: 600px) {
	  	font-size: 16px;
	  }
	  @media(min-width: 1024px) {
		margin-top: 24px;
		font-size: 18px;
	  }
	  --skew: 16deg;
	  color: theme(colors.black);
	  background: theme(colors.accent.400);
	  font-weight: 700;
	  text-align: center;
	  text-decoration: none;
	  border: 0;
	  outline: 0;
	  padding: 8px 24px;
	  display: inline-block;
	  transform: skew(calc(var(--skew) * -1));
	}

    /* Un-skew the text */
	.skew-button > span {
	  display: inline-block;
	  transform: skew(var(--skew));
	}

	.eth-logo {
		opacity: 0.2;
	}

	.trustless-connection {
		padding: 0 16px;
		margin: 0 -16px;
	}

	.animate-character {
	  -webkit-background-clip: text;
	  -webkit-text-fill-color: transparent;
	  animation: textclip 2s linear infinite;
		animation-direction: reverse;

	  background-image: linear-gradient(
	    100deg,
	    theme(colors.accent.400) 0%,
	    theme(colors.accent.400) 40%,
	    theme(colors.accent.200) 50%,
	    theme(colors.accent.400) 60%,
	    theme(colors.accent.400) 100%
	  );
	  background-size: 100% 100%;
	  background-size: 200% 100%;
		background-clip: text;
	}


	.animate-character-delay {
		animation-delay: -0.2s;
	}
</style>
